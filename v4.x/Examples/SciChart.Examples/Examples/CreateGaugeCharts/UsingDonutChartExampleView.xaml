<UserControl
    x:Class="SciChart.Examples.Examples.CreateGaugeCharts.UsingDonutChartExampleView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ext="http://schemas.abtsoftware.co.uk/scichart/exampleExternals"
    xmlns:gauge="clr-namespace:SciChart.Examples.Examples.CreateGaugeCharts"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:s="http://schemas.abtsoftware.co.uk/scichart"
    d:DesignHeight="400"
    d:DesignWidth="600"
    mc:Ignorable="d">

    <UserControl.Resources>

        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/SciChart.Examples.ExternalDependencies;component/Resources/Styles/MergedResources.xaml" />
                <ResourceDictionary Source="/SciChart.Examples.ExternalDependencies;component/Resources/Styles/ToolbarButtonsCommon.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <Style x:Key="DonutChartLegendStyle" TargetType="ListBox">
                <Setter Property="Foreground" Value="#FFDFE0E6" />
                <Setter Property="FontSize" Value="14" />
            </Style>

            <DataTemplate x:Key="OutsideLabelDataTemplate" DataType="s:IPieSegmentViewModel">
                <TextBlock
                    FontSize="14"
                    Foreground="#FFDFE0E6"
                    Text="{Binding Name}" />
            </DataTemplate>

            <DataTemplate x:Key="InsideLabelDataTemplate" DataType="s:IPieSegmentViewModel">
                <TextBlock
                    FontSize="14"
                    Foreground="Black"
                    Text="{Binding Percentage, StringFormat={}{0:#.##}%}" />
            </DataTemplate>

        </ResourceDictionary>

    </UserControl.Resources>

    <Grid>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <s:SciChartDonutSurface
            x:Name="donutSurface"
            Grid.Column="1"
            Background="#FF1C1C1F"
            ChartTitle="Accounting"
            FontSize="20"
            Foreground="#FFDFE0E6"
            InsideLabelTemplate="{StaticResource InsideLabelDataTemplate}"
            ItemsSource="{Binding DonutModels}"
            LegendListStyle="{StaticResource DonutChartLegendStyle}"
            SegmentSpacing="4">

            <i:Interaction.Behaviors>
                <gauge:EventToCommandBehavior
                    Command="{Binding SegmentSelectionCommand}"
                    Event="SelectionChanged"
                    PassArguments="True" />
            </i:Interaction.Behaviors>

            <s:SciChartDonutSurface.ItemTemplate>
                <DataTemplate DataType="gauge:DonutSegmentViewModel">
                    <s:DonutSegment
                        Fill="{Binding Fill, Mode=TwoWay}"
                        IsSelected="{Binding IsSelected, Mode=TwoWay}"
                        SegmentValue="{Binding Value, Mode=TwoWay}"
                        Stroke="{Binding Stroke, Mode=TwoWay}"
                        StrokeThickness="{Binding StrokeThickness, Mode=TwoWay}"
                        Text="{Binding Name, Mode=TwoWay}" />
                </DataTemplate>
            </s:SciChartDonutSurface.ItemTemplate>

            <s:SciChartDonutSurface.InfoLinesStyle>
                <Style TargetType="Line">
                    <Setter Property="Stroke" Value="#FFDFE0E6" />
                </Style>
            </s:SciChartDonutSurface.InfoLinesStyle>

            <s:SciChartDonutSurface.SegmentTooltipTemplate>
                <DataTemplate DataType="s:IPieSegmentViewModel">
                    <Grid Margin="3" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="3"
                            VerticalAlignment="Center"
                            FontSize="14"
                            Text="Name: " />

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="1"
                            Margin="3"
                            VerticalAlignment="Center"
                            FontSize="14"
                            Text="{Binding Name}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="3"
                            VerticalAlignment="Center"
                            FontSize="14"
                            Text="Value: " />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="3"
                            VerticalAlignment="Center"
                            FontSize="14"
                            Text="{Binding Value}" />

                    </Grid>
                </DataTemplate>
            </s:SciChartDonutSurface.SegmentTooltipTemplate>

        </s:SciChartDonutSurface>

        <Border
            Panel.ZIndex="9999"
            Background="#FF232426"
            BorderBrush="#323539"
            BorderThickness="0,0,2,0">

            <WrapPanel HorizontalAlignment="Left" Orientation="Vertical">

                <ToggleButton
                    HorizontalAlignment="Left"
                    Content="Tooltip"
                    ContentTemplate="{StaticResource TooltipIconContentTemplate}"
                    IsChecked="{Binding ShowTooltip, Mode=TwoWay, ElementName=donutSurface}"
                    Style="{StaticResource DefaultToggleButtonStyle}"
                    ToolTipService.ToolTip="Tooltip" />


                <ToggleButton
                    HorizontalAlignment="Left"
                    Content="Leg"
                    IsChecked="{Binding ShowLegend, Mode=TwoWay, ElementName=donutSurface}"
                    Style="{StaticResource DefaultToggleButtonStyle}"
                    ToolTipService.ToolTip="Legend" />

                <ToggleButton
                    HorizontalAlignment="Left"
                    Content="MSel"
                    FontSize="9"
                    IsChecked="{Binding AllowMultiSelect, Mode=TwoWay, ElementName=donutSurface}"
                    Style="{StaticResource DefaultToggleButtonStyle}"
                    ToolTipService.ToolTip="Allow multi select" />

                <ext:FlyoutMenuButton
                    Padding="0"
                    HorizontalAlignment="Left"
                    Content="Add"
                    FontSize="11"
                    Style="{StaticResource FlyoutMenuButtonStyle}"
                    ToolTipService.ToolTip="Add new item">

                    <ext:FlyoutMenuButton.PopupContent>
                        <StackPanel MinWidth="150" Orientation="Vertical">

                            <TextBlock
                                HorizontalAlignment="Center"
                                FontSize="14"
                                Text="Add new donut segment" />

                            <ext:FlyoutSeparator />

                            <Grid>

                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Margin="3"
                                    FontSize="14"
                                    Text="Text: " />
                                <TextBox
                                    x:Name="NewTextTBox"
                                    Grid.Column="1"
                                    Width="200"
                                    Height="20"
                                    Margin="3"
                                    HorizontalAlignment="Left"
                                    Text="{Binding NewSegmentText, Mode=TwoWay}" />
                                <TextBlock
                                    Grid.Row="1"
                                    Margin="3"
                                    FontSize="14"
                                    Text="Value:" />
                                <TextBox
                                    x:Name="NewValueTBox"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Width="200"
                                    Height="20"
                                    Margin="3"
                                    HorizontalAlignment="Left"
                                    PreviewTextInput="NewValueTBox_OnPreviewTextInput"
                                    Text="{Binding NewSegmentValue, Mode=TwoWay}" />
                                <TextBlock
                                    Grid.Row="2"
                                    Margin="3"
                                    FontSize="14"
                                    Text="Fill:" />

                                <ComboBox
                                    x:Name="BrushesComboBox"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Width="200"
                                    Margin="3"
                                    Background="#FF1C1C1F"
                                    ItemsSource="{Binding AllBrushes}"
                                    SelectedIndex="1"
                                    SelectedItem="{Binding NewSegmentBrush, Mode=OneWayToSource}">

                                    <ComboBox.ItemTemplate>
                                        <DataTemplate DataType="gauge:DonutBrushesModel">

                                            <StackPanel Orientation="Horizontal">

                                                <Rectangle
                                                    Width="18"
                                                    Height="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Width}"
                                                    Margin="3,0"
                                                    Fill="{Binding Brush}"
                                                    RadiusX="2"
                                                    RadiusY="2" />

                                                <TextBlock
                                                    Margin="3,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="14"
                                                    Foreground="White"
                                                    Text="{Binding BrushName}" />

                                            </StackPanel>

                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>

                            </Grid>

                            <ext:FlyoutSeparator />

                            <Button
                                Width="80"
                                Margin="3"
                                HorizontalAlignment="Right"
                                Command="{Binding AddNewItemCommand}"
                                Content="Add" />

                        </StackPanel>
                    </ext:FlyoutMenuButton.PopupContent>
                </ext:FlyoutMenuButton>


                <ext:FlyoutMenuButton
                    Padding="0"
                    HorizontalAlignment="Left"
                    Content="Edit"
                    FontSize="11"
                    Style="{StaticResource FlyoutMenuButtonStyle}"
                    ToolTipService.ToolTip="Edit selected segment">

                    <ext:FlyoutMenuButton.PopupContent>
                        <StackPanel MinWidth="150" Orientation="Vertical">

                            <TextBlock
                                HorizontalAlignment="Center"
                                FontSize="14"
                                Text="Edit last selected pie segment" />

                            <ext:FlyoutSeparator />
                            <Grid>

                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Margin="3"
                                    FontSize="14"
                                    Text="Text: " />
                                <TextBox
                                    Grid.Column="1"
                                    Width="200"
                                    Height="20"
                                    Margin="3"
                                    HorizontalAlignment="Left"
                                    Text="{Binding SelectedSegment.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                <TextBlock
                                    Grid.Row="1"
                                    Margin="3"
                                    FontSize="14"
                                    Text="Value:" />
                                <TextBox
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Width="200"
                                    Height="20"
                                    Margin="3"
                                    HorizontalAlignment="Left"
                                    PreviewTextInput="NewValueTBox_OnPreviewTextInput"
                                    Text="{Binding SelectedSegment.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                            </Grid>

                        </StackPanel>
                    </ext:FlyoutMenuButton.PopupContent>
                </ext:FlyoutMenuButton>

            </WrapPanel>
        </Border>

    </Grid>

</UserControl>
